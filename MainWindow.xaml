<Window x:Class="ExcelMatcher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Excel数据匹配合并工具"
        Height="1000" Width="1600"
        MinHeight="800" MinWidth="1200"
        TextElement.Foreground="{DynamicResource MD3OnSurfaceBrush}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="14"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MD3BackgroundBrush}"
        FontFamily="{materialDesign:MaterialDesignFont}"
        WindowStartupLocation="CenterScreen"
        AllowDrop="True"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip"
        AllowsTransparency="True">

    <!-- 窗口资源定义 -->
    <Window.Resources>
        <!-- 区域标题样式 -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock" BasedOn="{StaticResource MD3TitleLarge}">
            <Setter Property="Margin" Value="0,0,0,24" />
            <Setter Property="FontWeight" Value="Medium" />
        </Style>

        <!-- 信息卡片样式 -->
        <Style x:Key="InfoCardStyle" TargetType="materialDesign:Card" BasedOn="{StaticResource MD3OutlinedCard}">
            <Setter Property="Margin" Value="0,12,0,0" />
            <Setter Property="Background" Value="{StaticResource MD3PrimaryContainerBrush}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2" />
        </Style>

        <!-- 文件拖拽区域样式 -->
        <Style x:Key="FileDropZoneStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource MD3OutlineVariantBrush}" />
            <Setter Property="BorderThickness" Value="2" />
            <Setter Property="CornerRadius" Value="16" />
            <Setter Property="Background" Value="{StaticResource MD3SurfaceBrush}" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="MinHeight" Value="64" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.1" Color="{StaticResource MD3Surface}" />
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <!-- 鼠标悬停效果 -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource MD3PrimaryBrush}" />
                    <Setter Property="Background" Value="{StaticResource MD3PrimaryContainerBrush}" />
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect BlurRadius="12" ShadowDepth="4" Opacity="0.2"
                                              Color="{StaticResource MD3Primary}" />
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <!-- 拖拽激活效果 -->
                <DataTrigger Binding="{Binding IsDragOver}" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource MD3SecondaryBrush}" />
                    <Setter Property="Background" Value="{StaticResource MD3SecondaryContainerBrush}" />
                    <Setter Property="BorderThickness" Value="3" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- 字段映射项样式 -->
        <Style x:Key="FieldMappingItemStyle" TargetType="Grid">
            <Setter Property="Margin" Value="0,8" />
        </Style>

        <!-- 筛选条件项样式 -->
        <Style x:Key="FilterConditionItemStyle" TargetType="Grid">
            <Setter Property="Margin" Value="0,8" />
        </Style>

        <!-- 平滑出现动画 -->

        <!-- 滑入动画 -->
        <Storyboard x:Key="SlideUpAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                             From="30" To="0" Duration="0:0:0.5">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="0" To="1" Duration="0:0:0.5" />
        </Storyboard>

    </Window.Resources>

    <!-- 主对话框容器 -->
    <materialDesign:DialogHost Identifier="RootDialog">
        <materialDesign:DialogHost Identifier="ConfirmDialog">
            <Grid>
                <!-- 自定义窗口边框 -->
                <Border Background="{StaticResource MD3SurfaceBrush}"
                        CornerRadius="20"
                        BorderThickness="1"
                        BorderBrush="{StaticResource MD3OutlineVariantBrush}"
                        materialDesign:ElevationAssist.Elevation="Dp8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <!-- 标题栏 -->
                            <RowDefinition Height="Auto" />
                            <!-- 主内容区 -->
                            <RowDefinition Height="*" />
                            <!-- 底部操作栏 -->
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- 自定义标题栏 -->
                        <materialDesign:ColorZone Grid.Row="0"
                                                  Mode="Custom"
                                                  Background="{StaticResource MD3SurfaceBrush}"
                                                  Foreground="{StaticResource MD3OnSurfaceBrush}"
                                                  CornerRadius="20,20,0,0"
                                                  Padding="32,20"
                                                  MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!-- 应用图标和标题 -->
                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <!-- 主图标 -->
                                    <materialDesign:PackIcon Kind="TableMergeCells"
                                                             Width="36" Height="36"
                                                             VerticalAlignment="Center"
                                                             Foreground="{StaticResource MD3PrimaryBrush}" />
                                    <!-- 应用标题 -->
                                    <TextBlock Text="Excel数据匹配合并工具"
                                               Style="{StaticResource MD3HeadlineSmall}"
                                               VerticalAlignment="Center"
                                               FontWeight="Medium"
                                               Margin="20,0,0,0" />
                                    <!-- 版本标识 -->
                                    <materialDesign:Chip Content="Beta"
                                                         Background="{StaticResource MD3SecondaryContainerBrush}"
                                                         Foreground="{StaticResource MD3OnSecondaryContainerBrush}"
                                                         FontSize="10"
                                                         Margin="16,0,0,0" />
                                </StackPanel>

                                <!-- 窗口控制按钮 -->
                                <StackPanel Grid.Column="2" Orientation="Horizontal">
                                    <!-- 最小化按钮 -->
                                    <Button x:Name="MinimizeButton"
                                            Style="{StaticResource MaterialDesignIconForegroundButton}"
                                            ToolTip="最小化窗口"
                                            Click="MinimizeButton_Click"
                                            Margin="4,0">
                                        <materialDesign:PackIcon Kind="WindowMinimize"
                                                                 Width="20" Height="20" />
                                    </Button>

                                    <!-- 最大化/还原按钮 -->
                                    <Button x:Name="MaximizeButton"
                                            Style="{StaticResource MaterialDesignIconForegroundButton}"
                                            ToolTip="最大化窗口"
                                            Click="MaximizeButton_Click"
                                            Margin="4,0">
                                        <materialDesign:PackIcon Kind="WindowMaximize"
                                                                 Width="20" Height="20" />
                                    </Button>

                                    <!-- 关闭按钮 -->
                                    <Button x:Name="CloseButton"
                                            Style="{StaticResource MaterialDesignIconForegroundButton}"
                                            ToolTip="关闭应用程序"
                                            Click="CloseButton_Click"
                                            Margin="4,0">
                                        <materialDesign:PackIcon Kind="WindowClose"
                                                                 Width="20" Height="20"
                                                                 Foreground="{StaticResource MD3ErrorBrush}" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </materialDesign:ColorZone>

                        <!-- 主内容滚动区域 -->
                        <ScrollViewer Grid.Row="1"
                                      HorizontalScrollBarVisibility="Disabled"
                                      Style="{StaticResource MD3ScrollViewer}"
                                      Padding="32,24,32,0">
                            <StackPanel MaxWidth="1500" HorizontalAlignment="Center">

                                <!-- 第一部分：文件选择区域 -->
                                <materialDesign:Card Style="{StaticResource MD3Card}" Margin="0,0,0,24">
                                    <StackPanel>
                                        <!-- 添加滑入动画 -->
                                        <StackPanel.RenderTransform>
                                            <TranslateTransform />
                                        </StackPanel.RenderTransform>
                                        <StackPanel.Triggers>
                                            <EventTrigger RoutedEvent="Loaded">
                                                <BeginStoryboard Storyboard="{StaticResource SlideUpAnimation}" />
                                            </EventTrigger>
                                        </StackPanel.Triggers>

                                        <!-- 区域标题 -->
                                        <Grid Margin="0,0,0,32">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <!-- 标题图标和文字 -->
                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="FileDocument"
                                                                         Width="32" Height="32"
                                                                         VerticalAlignment="Center"
                                                                         Foreground="{StaticResource MD3PrimaryBrush}"
                                                                         Margin="0,0,16,0" />
                                                <TextBlock Text="文件选择"
                                                           Style="{StaticResource SectionHeaderStyle}"
                                                           Margin="0" />
                                            </StackPanel>

                                            <!-- 快速操作按钮 -->
                                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                <!-- 数据预览开关 -->
                                                <materialDesign:Card Style="{StaticResource MD3OutlinedCard}"
                                                                     Padding="16,12"
                                                                     Margin="0,0,16,0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="Eye"
                                                            Width="18" Height="18"
                                                            Margin="0,0,8,0"
                                                            Foreground="{StaticResource MD3PrimaryBrush}" />
                                                        <TextBlock Text="数据预览"
                                                                   Style="{StaticResource MD3LabelLarge}"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,12,0" />
                                                        <ToggleButton x:Name="PreviewToggleButton"
                                                                      IsChecked="{Binding IsPreviewEnabled}"
                                                                      Style="{StaticResource MaterialDesignSwitchToggleButton}"
                                                                      ToolTip="启用数据预览可查看文件内容，但会影响大文件处理性能" />
                                                    </StackPanel>
                                                </materialDesign:Card>

                                                <!-- 刷新数据按钮 -->
                                                <Button Command="{Binding RefreshDataCommand}"
                                                        Style="{StaticResource MD3OutlinedButton}"
                                                        ToolTip="重新加载文件数据">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="Refresh"
                                                            Width="18" Height="18"
                                                            Margin="0,0,8,0" />
                                                        <TextBlock Text="刷新数据" />
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                        </Grid>

                                        <!-- 主表文件选择 -->
                                        <Grid Margin="0,0,0,32">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!-- 主表标签 -->
                                            <TextBlock Grid.Column="0"
                                                       Text="主表文件"
                                                       Style="{StaticResource MD3LabelLarge}"
                                                       VerticalAlignment="Center" />

                                            <!-- 主表文件拖拽区域 -->
                                            <Border Grid.Column="1"
                                                    Style="{StaticResource FileDropZoneStyle}"
                                                    AllowDrop="True"
                                                    DragEnter="PrimaryFileDropZone_DragEnter"
                                                    DragOver="PrimaryFileDropZone_DragOver"
                                                    DragLeave="PrimaryFileDropZone_DragLeave"
                                                    Drop="PrimaryFileDropZone_Drop">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <!-- 文件图标 -->
                                                    <materialDesign:PackIcon Grid.Column="0"
                                                                             Kind="FileExcel"
                                                                             Width="28" Height="28"
                                                                             VerticalAlignment="Center"
                                                                             Foreground="{StaticResource MD3PrimaryBrush}"
                                                                             Margin="0,0,16,0" />

                                                    <!-- 文件路径显示 -->
                                                    <TextBox Grid.Column="1"
                                                             Text="{Binding PrimaryFilePath}"
                                                             Style="{StaticResource MD3TextBox}"
                                                             materialDesign:HintAssist.Hint="拖拽主表Excel文件到此处或点击浏览按钮"
                                                             IsReadOnly="True"
                                                             ToolTip="{Binding PrimaryFilePath}"
                                                             Margin="0,0,16,0" />

                                                    <!-- 密码输入框 -->
                                                    <PasswordBox Grid.Column="2"
                                                                 x:Name="PrimaryPasswordBox"
                                                                 materialDesign:HintAssist.Hint="文件密码(可选)"
                                                                 Style="{StaticResource MaterialDesignOutlinedPasswordBox}"
                                                                 Width="140"
                                                                 Margin="0,0,16,0"
                                                                 PasswordChanged="PrimaryPasswordBox_PasswordChanged" />

                                                    <!-- 浏览按钮 -->
                                                    <Button Grid.Column="3"
                                                            Command="{Binding BrowsePrimaryFileCommand}"
                                                            Style="{StaticResource MD3FilledButton}"
                                                            Margin="0,0,12,0">
                                                        <StackPanel Orientation="Horizontal">
                                                            <materialDesign:PackIcon Kind="FolderOpen"
                                                                Width="18" Height="18"
                                                                Margin="0,0,8,0" />
                                                            <TextBlock Text="浏览文件" />
                                                        </StackPanel>
                                                    </Button>

                                                    <!-- 清除按钮 -->
                                                    <Button Grid.Column="4"
                                                            Style="{StaticResource MaterialDesignIconButton}"
                                                            ToolTip="清除主表文件"
                                                            Command="{Binding ClearPrimaryFileCommand}"
                                                            Visibility="{Binding PrimaryFile.IsLoaded, 
                                                                  Converter={StaticResource BooleanToVisibilityConverter}}">
                                                        <materialDesign:PackIcon Kind="Close"
                                                            Foreground="{StaticResource MD3ErrorBrush}" />
                                                    </Button>
                                                </Grid>
                                            </Border>

                                            <!-- 主表文件信息卡片 -->
                                            <materialDesign:Card Grid.Row="1" Grid.Column="1"
                                                                 Style="{StaticResource InfoCardStyle}"
                                                                 Visibility="{Binding PrimaryFile.IsLoaded, 
                                                                       Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon Kind="CheckCircle"
                                                                             Foreground="{StaticResource MD3OnPrimaryContainerBrush}"
                                                                             Width="20" Height="20"
                                                                             Margin="0,0,12,0" />
                                                    <TextBlock Foreground="{StaticResource MD3OnPrimaryContainerBrush}"
                                                               Style="{StaticResource MD3BodyMedium}">
                                                        <Run Text="文件加载成功，包含" />
                                                        <Run Text="{Binding PrimaryFile.WorksheetCount, Mode=OneWay}"
                                                             FontWeight="Medium" />
                                                        <Run Text="个工作表" />
                                                    </TextBlock>
                                                </StackPanel>
                                            </materialDesign:Card>
                                        </Grid>

                                        <!-- 辅助表文件选择 -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!-- 辅助表标签 -->
                                            <TextBlock Grid.Column="0"
                                                       Text="辅助表文件"
                                                       Style="{StaticResource MD3LabelLarge}"
                                                       VerticalAlignment="Center" />

                                            <!-- 辅助表文件拖拽区域 -->
                                            <Border Grid.Column="1"
                                                    Style="{StaticResource FileDropZoneStyle}"
                                                    AllowDrop="True"
                                                    DragEnter="SecondaryFileDropZone_DragEnter"
                                                    DragOver="SecondaryFileDropZone_DragOver"
                                                    DragLeave="SecondaryFileDropZone_DragLeave"
                                                    Drop="SecondaryFileDropZone_Drop">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <!-- 文件图标 -->
                                                    <materialDesign:PackIcon Grid.Column="0"
                                                                             Kind="FileExcel"
                                                                             Width="28" Height="28"
                                                                             VerticalAlignment="Center"
                                                                             Foreground="{StaticResource MD3SecondaryBrush}"
                                                                             Margin="0,0,16,0" />

                                                    <!-- 文件路径显示 -->
                                                    <TextBox Grid.Column="1"
                                                             Text="{Binding SecondaryFilePath}"
                                                             Style="{StaticResource MD3TextBox}"
                                                             materialDesign:HintAssist.Hint="拖拽辅助表Excel文件到此处或点击浏览按钮"
                                                             IsReadOnly="True"
                                                             ToolTip="{Binding SecondaryFilePath}"
                                                             Margin="0,0,16,0" />

                                                    <!-- 密码输入框 -->
                                                    <PasswordBox Grid.Column="2"
                                                                 x:Name="SecondaryPasswordBox"
                                                                 materialDesign:HintAssist.Hint="文件密码(可选)"
                                                                 Style="{StaticResource MaterialDesignOutlinedPasswordBox}"
                                                                 Width="140"
                                                                 Margin="0,0,16,0"
                                                                 PasswordChanged="SecondaryPasswordBox_PasswordChanged" />

                                                    <!-- 浏览按钮 -->
                                                    <Button Grid.Column="3"
                                                            Command="{Binding BrowseSecondaryFileCommand}"
                                                            Style="{StaticResource MD3FilledButton}"
                                                            Margin="0,0,12,0">
                                                        <StackPanel Orientation="Horizontal">
                                                            <materialDesign:PackIcon Kind="FolderOpen"
                                                                Width="18" Height="18"
                                                                Margin="0,0,8,0" />
                                                            <TextBlock Text="浏览文件" />
                                                        </StackPanel>
                                                    </Button>

                                                    <!-- 清除按钮 -->
                                                    <Button Grid.Column="4"
                                                            Style="{StaticResource MaterialDesignIconButton}"
                                                            Command="{Binding ClearSecondaryFileCommand}"
                                                            ToolTip="清除辅助表文件"
                                                            Visibility="{Binding SecondaryFile.IsLoaded, 
                                                                  Converter={StaticResource BooleanToVisibilityConverter}}">
                                                        <materialDesign:PackIcon Kind="Close"
                                                            Foreground="{StaticResource MD3ErrorBrush}" />
                                                    </Button>
                                                </Grid>
                                            </Border>

                                            <!-- 辅助表文件信息卡片 -->
                                            <materialDesign:Card Grid.Row="1" Grid.Column="1"
                                                                 Style="{StaticResource InfoCardStyle}"
                                                                 Visibility="{Binding SecondaryFile.IsLoaded, 
                                                                       Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon Kind="CheckCircle"
                                                                             Foreground="{StaticResource MD3OnPrimaryContainerBrush}"
                                                                             Width="20" Height="20"
                                                                             Margin="0,0,12,0" />
                                                    <TextBlock Foreground="{StaticResource MD3OnPrimaryContainerBrush}"
                                                               Style="{StaticResource MD3BodyMedium}">
                                                        <Run Text="文件加载成功，包含" />
                                                        <Run Text="{Binding SecondaryFile.WorksheetCount, Mode=OneWay}"
                                                             FontWeight="Medium" />
                                                        <Run Text="个工作表" />
                                                    </TextBlock>
                                                </StackPanel>
                                            </materialDesign:Card>
                                        </Grid>
                                    </StackPanel>
                                </materialDesign:Card>

                                <!-- 第二部分：工作表选择区域 -->
                                <materialDesign:Card Style="{StaticResource MD3Card}" Margin="0,0,0,24">
                                    <StackPanel>
                                        <!-- 区域标题 -->
                                        <Grid Margin="0,0,0,32">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="TableMultiple"
                                                                         Width="32" Height="32"
                                                                         VerticalAlignment="Center"
                                                                         Foreground="{StaticResource MD3PrimaryBrush}"
                                                                         Margin="0,0,16,0" />
                                                <TextBlock Text="工作表选择"
                                                           Style="{StaticResource SectionHeaderStyle}"
                                                           Margin="0" />
                                            </StackPanel>
                                        </Grid>

                                        <!-- 工作表选择界面 -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="64" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <!-- 主表工作表选择 -->
                                            <materialDesign:Card Grid.Column="0"
                                                                 Style="{StaticResource MD3OutlinedCard}">
                                                <StackPanel>
                                                    <!-- 主表工作表标题 -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                                        <materialDesign:PackIcon Kind="Table"
                                                            Foreground="{StaticResource MD3PrimaryBrush}"
                                                            Width="24" Height="24"
                                                            Margin="0,0,12,0" />
                                                        <TextBlock Text="主表工作表" Style="{StaticResource MD3TitleMedium}" />
                                                    </StackPanel>

                                                    <!-- 主表工作表列表 -->
                                                    <ListBox x:Name="PrimaryWorksheetsListBox"
                                                             ItemsSource="{Binding PrimaryWorksheets}"
                                                             SelectionMode="Extended"
                                                             Style="{StaticResource MD3ListBox}"
                                                             MaxHeight="240"
                                                             MinHeight="140">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="SelectionChanged">
                                                                <i:InvokeCommandAction
                                                                    Command="{Binding UpdateSelectedPrimaryWorksheetsCommand}"
                                                                    CommandParameter="{Binding ElementName=PrimaryWorksheetsListBox, Path=SelectedItems}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </ListBox>

                                                    <!-- 主表选择信息 -->
                                                    <materialDesign:Card Style="{StaticResource MD3OutlinedCard}"
                                                                         Margin="0,20,0,0"
                                                                         Background="{StaticResource MD3SecondaryContainerBrush}">
                                                        <StackPanel>
                                                            <TextBlock Style="{StaticResource MD3LabelMedium}"
                                                                       Foreground="{StaticResource MD3OnSecondaryContainerBrush}">
                                                                <materialDesign:PackIcon Kind="CheckboxMarked"
                                                                    Width="16" Height="16"
                                                                    VerticalAlignment="Center"
                                                                    Margin="0,0,8,0" />
                                                                <Run Text="已选择" />
                                                                <Run
                                                                    Text="{Binding SelectedPrimaryWorksheets.Count, Mode=OneWay}"
                                                                    FontWeight="Bold" />
                                                                <Run Text="个工作表" />
                                                            </TextBlock>
                                                        </StackPanel>
                                                    </materialDesign:Card>
                                                </StackPanel>
                                            </materialDesign:Card>

                                            <!-- 连接箭头 -->
                                            <Grid Grid.Column="1">
                                                <materialDesign:PackIcon Kind="ArrowLeftRight"
                                                                         HorizontalAlignment="Center"
                                                                         VerticalAlignment="Center"
                                                                         Width="40" Height="40"
                                                                         Foreground="{StaticResource MD3PrimaryBrush}" />
                                            </Grid>

                                            <!-- 辅助表工作表选择 -->
                                            <materialDesign:Card Grid.Column="2"
                                                                 Style="{StaticResource MD3OutlinedCard}">
                                                <StackPanel>
                                                    <!-- 辅助表工作表标题 -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                                        <materialDesign:PackIcon Kind="Table"
                                                            Foreground="{StaticResource MD3SecondaryBrush}"
                                                            Width="24" Height="24"
                                                            Margin="0,0,12,0" />
                                                        <TextBlock Text="辅助表工作表"
                                                                   Style="{StaticResource MD3TitleMedium}" />
                                                    </StackPanel>

                                                    <!-- 辅助表工作表列表 -->
                                                    <ListBox x:Name="SecondaryWorksheetsListBox"
                                                             ItemsSource="{Binding SecondaryWorksheets}"
                                                             SelectionMode="Extended"
                                                             Style="{StaticResource MD3ListBox}"
                                                             MaxHeight="240"
                                                             MinHeight="140">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="SelectionChanged">
                                                                <i:InvokeCommandAction
                                                                    Command="{Binding UpdateSelectedSecondaryWorksheetsCommand}"
                                                                    CommandParameter="{Binding ElementName=SecondaryWorksheetsListBox, Path=SelectedItems}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </ListBox>

                                                    <!-- 辅助表选择信息 -->
                                                    <materialDesign:Card Style="{StaticResource MD3OutlinedCard}"
                                                                         Margin="0,20,0,0"
                                                                         Background="{StaticResource MD3SecondaryContainerBrush}">
                                                        <StackPanel>
                                                            <TextBlock Style="{StaticResource MD3LabelMedium}"
                                                                       Foreground="{StaticResource MD3OnSecondaryContainerBrush}">
                                                                <materialDesign:PackIcon Kind="CheckboxMarked"
                                                                    Width="16" Height="16"
                                                                    VerticalAlignment="Center"
                                                                    Margin="0,0,8,0" />
                                                                <Run Text="已选择" />
                                                                <Run
                                                                    Text="{Binding SelectedSecondaryWorksheets.Count, Mode=OneWay}"
                                                                    FontWeight="Bold" />
                                                                <Run Text="个工作表" />
                                                            </TextBlock>
                                                        </StackPanel>
                                                    </materialDesign:Card>
                                                </StackPanel>
                                            </materialDesign:Card>
                                        </Grid>
                                    </StackPanel>
                                </materialDesign:Card>

                                <!-- 第三部分：字段配置区域 -->
                                <materialDesign:Card Style="{StaticResource MD3Card}" Margin="0,0,0,24">
                                    <StackPanel>
                                        <!-- 区域标题 -->
                                        <Grid Margin="0,0,0,32">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="LinkVariant"
                                                                         Width="32" Height="32"
                                                                         VerticalAlignment="Center"
                                                                         Foreground="{StaticResource MD3PrimaryBrush}"
                                                                         Margin="0,0,16,0" />
                                                <TextBlock Text="字段配置"
                                                           Style="{StaticResource SectionHeaderStyle}"
                                                           Margin="0" />
                                            </StackPanel>
                                        </Grid>

                                        <!-- 匹配字段选择 -->
                                        <materialDesign:Card Style="{StaticResource MD3OutlinedCard}" Margin="0,0,0,32">
                                            <StackPanel>
                                                <!-- 匹配字段标题 -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                                    <materialDesign:PackIcon Kind="LinkBox"
                                                                             Foreground="{StaticResource MD3PrimaryBrush}"
                                                                             Width="28" Height="28"
                                                                             Margin="0,0,16,0" />
                                                    <TextBlock Text="匹配字段选择" Style="{StaticResource MD3TitleMedium}" />
                                                    <materialDesign:PackIcon Kind="InformationOutline"
                                                                             Width="20" Height="20"
                                                                             Margin="20,0,8,0"
                                                                             Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                             ToolTip="选择用于匹配主表和辅助表数据的字段，字段数量必须相等" />
                                                </StackPanel>

                                                <!-- 匹配字段选择界面 -->
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>

                                                    <!-- 主表匹配字段 -->
                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="主表匹配字段"
                                                                   Style="{StaticResource MD3LabelLarge}"
                                                                   Margin="0,0,0,12" />
                                                        <materialDesign:Card Style="{StaticResource MD3OutlinedCard}">
                                                            <ListBox x:Name="PrimaryMatchFieldsListBox"
                                                                     ItemsSource="{Binding PrimaryColumns}"
                                                                     SelectionMode="Extended"
                                                                     Style="{StaticResource MD3ListBox}"
                                                                     Height="200">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction
                                                                            Command="{Binding UpdateSelectedPrimaryMatchFieldsCommand}"
                                                                            CommandParameter="{Binding ElementName=PrimaryMatchFieldsListBox, Path=SelectedItems}" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ListBox>
                                                        </materialDesign:Card>
                                                    </StackPanel>

                                                    <!-- 匹配指示器 -->
                                                    <StackPanel Grid.Column="1"
                                                                VerticalAlignment="Center"
                                                                Margin="32,0">
                                                        <materialDesign:PackIcon Kind="ArrowLeftRight"
                                                            Width="48" Height="48"
                                                            Foreground="{StaticResource MD3PrimaryBrush}" />
                                                        <TextBlock Text="匹配关联"
                                                                   Style="{StaticResource MD3LabelMedium}"
                                                                   HorizontalAlignment="Center"
                                                                   Margin="0,12,0,0" />
                                                    </StackPanel>

                                                    <!-- 辅助表匹配字段 -->
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="辅助表匹配字段"
                                                                   Style="{StaticResource MD3LabelLarge}"
                                                                   Margin="0,0,0,12" />
                                                        <materialDesign:Card Style="{StaticResource MD3OutlinedCard}">
                                                            <ListBox x:Name="SecondaryMatchFieldsListBox"
                                                                     ItemsSource="{Binding SecondaryColumns}"
                                                                     SelectionMode="Extended"
                                                                     Style="{StaticResource MD3ListBox}"
                                                                     Height="200">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction
                                                                            Command="{Binding UpdateSelectedSecondaryMatchFieldsCommand}"
                                                                            CommandParameter="{Binding ElementName=SecondaryMatchFieldsListBox, Path=SelectedItems}" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ListBox>
                                                        </materialDesign:Card>
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!-- 字段映射配置 -->
                                        <materialDesign:Card Style="{StaticResource MD3OutlinedCard}">
                                            <StackPanel>
                                                <!-- 字段映射标题 -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                                    <materialDesign:PackIcon Kind="MapMarker"
                                                                             Foreground="{StaticResource MD3SecondaryBrush}"
                                                                             Width="28" Height="28"
                                                                             Margin="0,0,16,0" />
                                                    <TextBlock Text="字段映射配置" Style="{StaticResource MD3TitleMedium}" />
                                                    <TextBlock Text="（辅助表 → 主表）"
                                                               Style="{StaticResource MD3LabelMedium}"
                                                               Margin="12,0,0,0" />
                                                    <materialDesign:PackIcon Kind="InformationOutline"
                                                                             Width="20" Height="20"
                                                                             Margin="20,0,8,0"
                                                                             Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                             ToolTip="配置将辅助表数据复制到主表的字段映射关系" />
                                                </StackPanel>

                                                <!-- 映射表头 -->
                                                <Grid Margin="0,0,0,12">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0"
                                                               Text="源字段 (辅助表)"
                                                               Style="{StaticResource MD3LabelLarge}"
                                                               Margin="12,0,0,0" />
                                                    <TextBlock Grid.Column="2"
                                                               Text="目标字段 (主表)"
                                                               Style="{StaticResource MD3LabelLarge}"
                                                               Margin="12,0,0,0" />
                                                    <TextBlock Grid.Column="3"
                                                               Text="操作"
                                                               Style="{StaticResource MD3LabelLarge}"
                                                               HorizontalAlignment="Center" />
                                                </Grid>

                                                <!-- 字段映射列表 -->
                                                <ScrollViewer MaxHeight="360"
                                                              Style="{StaticResource MD3ScrollViewer}">
                                                    <ItemsControl ItemsSource="{Binding FieldMappings}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <materialDesign:Card
                                                                    Style="{StaticResource MD3OutlinedCard}"
                                                                    Margin="0,6">
                                                                    <Grid
                                                                        Style="{StaticResource FieldMappingItemStyle}">
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="*" />
                                                                            <ColumnDefinition Width="Auto" />
                                                                            <ColumnDefinition Width="*" />
                                                                            <ColumnDefinition Width="Auto" />
                                                                        </Grid.ColumnDefinitions>

                                                                        <!-- 源字段选择 -->
                                                                        <ComboBox Grid.Column="0"
                                                                            ItemsSource="{Binding DataContext.SecondaryColumns, 
                                                                                        RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            SelectedItem="{Binding SourceField, UpdateSourceTrigger=PropertyChanged}"
                                                                            Style="{StaticResource MD3ComboBox}"
                                                                            materialDesign:HintAssist.Hint="选择源字段"
                                                                            ToolTip="选择辅助表中的源字段" />

                                                                        <!-- 映射箭头 -->
                                                                        <materialDesign:PackIcon Grid.Column="1"
                                                                            Kind="ArrowRight"
                                                                            VerticalAlignment="Center"
                                                                            Margin="20,0"
                                                                            Foreground="{StaticResource MD3PrimaryBrush}" />

                                                                        <!-- 目标字段选择 -->
                                                                        <ComboBox Grid.Column="2"
                                                                            ItemsSource="{Binding DataContext.PrimaryColumns, 
                                                                                        RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            SelectedItem="{Binding TargetField, UpdateSourceTrigger=PropertyChanged}"
                                                                            Text="{Binding TargetField, UpdateSourceTrigger=PropertyChanged}"
                                                                            Style="{StaticResource MD3EditableComboBox}"
                                                                            materialDesign:HintAssist.Hint="选择或输入目标字段"
                                                                            ToolTip="选择主表中的目标字段或输入新字段名" />

                                                                        <!-- 删除按钮 -->
                                                                        <Button Grid.Column="3"
                                                                            Command="{Binding DataContext.RemoveFieldMappingCommand, 
                                                                                      RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            CommandParameter="{Binding}"
                                                                            Style="{StaticResource MaterialDesignIconButton}"
                                                                            Margin="20,0,0,0"
                                                                            ToolTip="删除此字段映射">
                                                                            <materialDesign:PackIcon
                                                                                Kind="DeleteOutline"
                                                                                Foreground="{StaticResource MD3ErrorBrush}" />
                                                                        </Button>
                                                                    </Grid>
                                                                </materialDesign:Card>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </ScrollViewer>

                                                <!-- 添加映射按钮 -->
                                                <Button Command="{Binding AddFieldMappingCommand}"
                                                        Style="{StaticResource MD3OutlinedButton}"
                                                        HorizontalAlignment="Left"
                                                        Margin="0,20,0,0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="Plus"
                                                            Width="18" Height="18"
                                                            Margin="0,0,8,0" />
                                                        <TextBlock Text="添加字段映射" />
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                        </materialDesign:Card>
                                    </StackPanel>
                                </materialDesign:Card>

                                <!-- 第四部分：数据筛选区域 -->
                                <materialDesign:Card Style="{StaticResource MD3Card}" Margin="0,0,0,24">
                                    <StackPanel>
                                        <!-- 区域标题 -->
                                        <Grid Margin="0,0,0,32">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="FilterVariant"
                                                                         Width="32" Height="32"
                                                                         VerticalAlignment="Center"
                                                                         Foreground="{StaticResource MD3PrimaryBrush}"
                                                                         Margin="0,0,16,0" />
                                                <TextBlock Text="数据筛选"
                                                           Style="{StaticResource SectionHeaderStyle}"
                                                           Margin="0" />
                                            </StackPanel>
                                        </Grid>

                                        <!-- 主表筛选条件 -->
                                        <Expander Header="主表筛选条件"
                                                  IsExpanded="False"
                                                  Style="{StaticResource MD3ExpanderSimple}"
                                                  Margin="0,0,0,20">
                                            <StackPanel Margin="0,20,0,0">
                                                <!-- 主表筛选列表 -->
                                                <ItemsControl ItemsSource="{Binding PrimaryFilters}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <materialDesign:Card
                                                                Style="{StaticResource MD3OutlinedCard}"
                                                                Margin="0,6">
                                                                <Grid Style="{StaticResource FilterConditionItemStyle}">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto" />
                                                                        <ColumnDefinition Width="*" />
                                                                        <ColumnDefinition Width="Auto" />
                                                                        <ColumnDefinition Width="*" />
                                                                        <ColumnDefinition Width="Auto" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <!-- 逻辑运算符 -->
                                                                    <ComboBox Grid.Column="0"
                                                                              ItemsSource="{Binding DataContext.LogicalOperators, 
                                                                                RelativeSource={RelativeSource AncestorType=Window}}"
                                                                              SelectedItem="{Binding LogicalOperator, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource MD3ComboBox}"
                                                                              materialDesign:HintAssist.Hint="逻辑关系"
                                                                              Width="100"
                                                                              Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ContentPresenter}}, 
                                                                                Converter={StaticResource IndexToVisibilityConverter}}">
                                                                        <ComboBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock
                                                                                    Text="{Binding Converter={StaticResource EnumDescriptionConverter}}"
                                                                                    Style="{StaticResource MD3BodyMedium}" />
                                                                            </DataTemplate>
                                                                        </ComboBox.ItemTemplate>
                                                                    </ComboBox>

                                                                    <!-- 字段选择 -->
                                                                    <ComboBox Grid.Column="1"
                                                                              ItemsSource="{Binding DataContext.PrimaryColumns, 
                                                                                RelativeSource={RelativeSource AncestorType=Window}}"
                                                                              SelectedItem="{Binding Field, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource MD3ComboBox}"
                                                                              materialDesign:HintAssist.Hint="选择字段"
                                                                              Margin="12,0" />

                                                                    <!-- 运算符选择 -->
                                                                    <ComboBox Grid.Column="2"
                                                                              ItemsSource="{Binding DataContext.FilterOperators, 
                                                                                RelativeSource={RelativeSource AncestorType=Window}}"
                                                                              SelectedItem="{Binding Operator, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource MD3ComboBox}"
                                                                              materialDesign:HintAssist.Hint="运算符"
                                                                              Width="160"
                                                                              Margin="0,0,12,0">
                                                                        <ComboBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock
                                                                                    Text="{Binding Converter={StaticResource EnumDescriptionConverter}}"
                                                                                    Style="{StaticResource MD3BodyMedium}" />
                                                                            </DataTemplate>
                                                                        </ComboBox.ItemTemplate>
                                                                    </ComboBox>

                                                                    <!-- 筛选值输入 -->
                                                                    <TextBox Grid.Column="3"
                                                                             Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                                                                             Style="{StaticResource MD3TextBox}"
                                                                             materialDesign:HintAssist.Hint="输入筛选值"
                                                                             Margin="0,0,12,0" />

                                                                    <!-- 删除按钮 -->
                                                                    <Button Grid.Column="4"
                                                                            Command="{Binding DataContext.RemovePrimaryFilterCommand, 
                                                                              RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            CommandParameter="{Binding}"
                                                                            Style="{StaticResource MaterialDesignIconButton}">
                                                                        <materialDesign:PackIcon Kind="DeleteOutline"
                                                                            Foreground="{StaticResource MD3ErrorBrush}" />
                                                                    </Button>
                                                                </Grid>
                                                            </materialDesign:Card>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>

                                                <!-- 添加主表筛选按钮 -->
                                                <Button Command="{Binding AddPrimaryFilterCommand}"
                                                        Style="{StaticResource MD3OutlinedButton}"
                                                        HorizontalAlignment="Left"
                                                        Margin="0,20,0,0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="Plus"
                                                            Width="18" Height="18"
                                                            Margin="0,0,8,0" />
                                                        <TextBlock Text="添加筛选条件" />
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                        </Expander>

                                        <!-- 辅助表筛选条件 -->
                                        <Expander Header="辅助表筛选条件"
                                                  IsExpanded="False"
                                                  Style="{StaticResource MD3ExpanderSimple}">
                                            <StackPanel Margin="0,20,0,0">
                                                <!-- 辅助表筛选列表 -->
                                                <ItemsControl ItemsSource="{Binding SecondaryFilters}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <materialDesign:Card
                                                                Style="{StaticResource MD3OutlinedCard}"
                                                                Margin="0,6">
                                                                <Grid Style="{StaticResource FilterConditionItemStyle}">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto" />
                                                                        <ColumnDefinition Width="*" />
                                                                        <ColumnDefinition Width="Auto" />
                                                                        <ColumnDefinition Width="*" />
                                                                        <ColumnDefinition Width="Auto" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <!-- 逻辑运算符 -->
                                                                    <ComboBox Grid.Column="0"
                                                                              ItemsSource="{Binding DataContext.LogicalOperators, 
                                                                                RelativeSource={RelativeSource AncestorType=Window}}"
                                                                              SelectedItem="{Binding LogicalOperator, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource MD3ComboBox}"
                                                                              materialDesign:HintAssist.Hint="逻辑关系"
                                                                              Width="100"
                                                                              Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ContentPresenter}}, 
                                                                                Converter={StaticResource IndexToVisibilityConverter}}">
                                                                        <ComboBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock
                                                                                    Text="{Binding Converter={StaticResource EnumDescriptionConverter}}"
                                                                                    Style="{StaticResource MD3BodyMedium}" />
                                                                            </DataTemplate>
                                                                        </ComboBox.ItemTemplate>
                                                                    </ComboBox>

                                                                    <!-- 字段选择 -->
                                                                    <ComboBox Grid.Column="1"
                                                                              ItemsSource="{Binding DataContext.SecondaryColumns, 
                                                                                RelativeSource={RelativeSource AncestorType=Window}}"
                                                                              SelectedItem="{Binding Field, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource MD3ComboBox}"
                                                                              materialDesign:HintAssist.Hint="选择字段"
                                                                              Margin="12,0" />

                                                                    <!-- 运算符选择 -->
                                                                    <ComboBox Grid.Column="2"
                                                                              ItemsSource="{Binding DataContext.FilterOperators, 
                                                                                RelativeSource={RelativeSource AncestorType=Window}}"
                                                                              SelectedItem="{Binding Operator, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource MD3ComboBox}"
                                                                              materialDesign:HintAssist.Hint="运算符"
                                                                              Width="160"
                                                                              Margin="0,0,12,0">
                                                                        <ComboBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock
                                                                                    Text="{Binding Converter={StaticResource EnumDescriptionConverter}}"
                                                                                    Style="{StaticResource MD3BodyMedium}" />
                                                                            </DataTemplate>
                                                                        </ComboBox.ItemTemplate>
                                                                    </ComboBox>

                                                                    <!-- 筛选值输入 -->
                                                                    <TextBox Grid.Column="3"
                                                                             Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                                                                             Style="{StaticResource MD3TextBox}"
                                                                             materialDesign:HintAssist.Hint="输入筛选值"
                                                                             Margin="0,0,12,0" />

                                                                    <!-- 删除按钮 -->
                                                                    <Button Grid.Column="4"
                                                                            Command="{Binding DataContext.RemoveSecondaryFilterCommand, 
                                                                              RelativeSource={RelativeSource AncestorType=Window}}"
                                                                            CommandParameter="{Binding}"
                                                                            Style="{StaticResource MaterialDesignIconButton}">
                                                                        <materialDesign:PackIcon Kind="DeleteOutline"
                                                                            Foreground="{StaticResource MD3ErrorBrush}" />
                                                                    </Button>
                                                                </Grid>
                                                            </materialDesign:Card>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>

                                                <!-- 添加辅助表筛选按钮 -->
                                                <Button Command="{Binding AddSecondaryFilterCommand}"
                                                        Style="{StaticResource MD3OutlinedButton}"
                                                        HorizontalAlignment="Left"
                                                        Margin="0,20,0,0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="Plus"
                                                            Width="18" Height="18"
                                                            Margin="0,0,8,0" />
                                                        <TextBlock Text="添加筛选条件" />
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                        </Expander>
                                    </StackPanel>
                                </materialDesign:Card>

                                <!-- 第五部分：数据预览区域 -->
                                <materialDesign:Card Style="{StaticResource MD3Card}" Margin="0,0,0,24">
                                    <StackPanel>
                                        <!-- 区域标题 -->
                                        <Grid Margin="0,0,0,32">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="Eye"
                                                                         Width="32" Height="32"
                                                                         VerticalAlignment="Center"
                                                                         Foreground="{StaticResource MD3PrimaryBrush}"
                                                                         Margin="0,0,16,0" />
                                                <TextBlock Text="数据预览"
                                                           Style="{StaticResource SectionHeaderStyle}"
                                                           Margin="0" />
                                            </StackPanel>
                                        </Grid>

                                        <!-- 数据预览内容区 -->
                                        <Grid Margin="0,20,0,0">
                                            <!-- 预览已禁用的提示界面 -->
                                            <StackPanel VerticalAlignment="Center"
                                                        HorizontalAlignment="Center"
                                                        Margin="0,40,0,60"
                                                        Visibility="{Binding IsPreviewEnabled, 
                                                                      Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                                <!-- 禁用图标 -->
                                                <materialDesign:PackIcon Kind="EyeOff"
                                                                         Width="80" Height="80"
                                                                         Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                         Margin="0,0,0,24" />
                                                <!-- 主标题 -->
                                                <TextBlock Text="数据预览已关闭"
                                                           Style="{StaticResource MD3HeadlineSmall}"
                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                           HorizontalAlignment="Center"
                                                           FontWeight="Medium"
                                                           Margin="0,0,0,12" />
                                                <!-- 副标题 -->
                                                <TextBlock Text="当前运行在性能优化模式下"
                                                           Style="{StaticResource MD3BodyLarge}"
                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,0,0,20" />
                                                <!-- 说明文字 -->
                                                <TextBlock Text="启用数据预览开关可查看文件内容，但会影响大文件处理性能。关闭预览可显著提高加载速度。"
                                                           Style="{StaticResource MD3BodyMedium}"
                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                           HorizontalAlignment="Center"
                                                           TextWrapping="Wrap"
                                                           MaxWidth="500"
                                                           TextAlignment="Center"
                                                           Margin="0,0,0,32" />

                                                <!-- 启用预览按钮 -->
                                                <Button Style="{StaticResource MD3FilledButton}"
                                                        Click="EnablePreview_Click"
                                                        Padding="24,12">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="Eye"
                                                            Width="20" Height="20"
                                                            Margin="0,0,12,0" />
                                                        <TextBlock Text="启用数据预览" FontWeight="Medium" />
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>

                                            <!-- 数据预览标签页 -->
                                            <ScrollViewer
                                                Visibility="{Binding IsPreviewEnabled, 
                                                                        Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <TabControl Style="{StaticResource MD3TabControl}">
                                                    <!-- 主表数据标签页 -->
                                                    <TabItem Style="{StaticResource MD3TabItem}">
                                                        <TabItem.Header>
                                                            <StackPanel Orientation="Horizontal">
                                                                <materialDesign:PackIcon Kind="Table"
                                                                    Width="22" Height="22"
                                                                    Margin="0,0,12,0" />
                                                                <TextBlock Text="主表数据" FontWeight="Medium" />
                                                                <!-- 工作表数量标识 -->
                                                                <materialDesign:Chip
                                                                    Content="{Binding SelectedPrimaryWorksheets.Count, StringFormat='{}{0}个工作表'}"
                                                                    Margin="12,0,0,0"
                                                                    Style="{StaticResource MaterialDesignOutlineChip}"
                                                                    FontSize="11"
                                                                    Visibility="{Binding SelectedPrimaryWorksheets.Count, 
                                                                                   Converter={StaticResource CountToVisibilityConverter}}" />
                                                            </StackPanel>
                                                        </TabItem.Header>
                                                        <Grid Margin="0,20,0,0">
                                                            <!-- 主表空状态 -->
                                                            <StackPanel VerticalAlignment="Center"
                                                                        HorizontalAlignment="Center"
                                                                        Margin="0,60,0,60"
                                                                        Visibility="{Binding HasPrimaryPreviewData, 
                                                                                      Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                                                <materialDesign:PackIcon Kind="TableOff"
                                                                    Width="64" Height="64"
                                                                    Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                    Margin="0,0,0,20" />
                                                                <TextBlock Text="请先选择主表工作表"
                                                                           Style="{StaticResource MD3BodyLarge}"
                                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                           HorizontalAlignment="Center"
                                                                           FontWeight="Medium" />
                                                                <TextBlock Text="选择工作表后将显示数据预览"
                                                                           Style="{StaticResource MD3BodyMedium}"
                                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                           HorizontalAlignment="Center"
                                                                           Margin="0,8,0,0" />
                                                            </StackPanel>

                                                            <!-- 主表数据显示 -->
                                                            <ScrollViewer
                                                                Visibility="{Binding HasPrimaryPreviewData, 
                                                                                        Converter={StaticResource BooleanToVisibilityConverter}}"
                                                                MaxHeight="500"
                                                                Style="{StaticResource MD3ScrollViewer}">
                                                                <StackPanel>
                                                                    <!-- 数据网格 -->
                                                                    <DataGrid
                                                                        ItemsSource="{Binding PrimaryPreviewData}"
                                                                        Style="{StaticResource MD3DataGrid}"
                                                                        AutoGenerateColumns="True"
                                                                        IsReadOnly="True"
                                                                        MaxHeight="450"
                                                                        materialDesign:DataGridAssist.CellPadding="8,4"
                                                                        materialDesign:DataGridAssist.ColumnHeaderPadding="8,8" />
                                                                </StackPanel>
                                                            </ScrollViewer>
                                                        </Grid>
                                                    </TabItem>

                                                    <!-- 辅助表数据标签页 -->
                                                    <TabItem Style="{StaticResource MD3TabItem}">
                                                        <TabItem.Header>
                                                            <StackPanel Orientation="Horizontal">
                                                                <materialDesign:PackIcon Kind="Table"
                                                                    Width="22" Height="22"
                                                                    Margin="0,0,12,0" />
                                                                <TextBlock Text="辅助表数据" FontWeight="Medium" />
                                                                <!-- 工作表数量标识 -->
                                                                <materialDesign:Chip
                                                                    Content="{Binding SelectedSecondaryWorksheets.Count, StringFormat='{}{0}个工作表'}"
                                                                    Margin="12,0,0,0"
                                                                    Style="{StaticResource MaterialDesignOutlineChip}"
                                                                    FontSize="11"
                                                                    Visibility="{Binding SelectedSecondaryWorksheets.Count, 
                                                                                   Converter={StaticResource CountToVisibilityConverter}}" />
                                                            </StackPanel>
                                                        </TabItem.Header>
                                                        <Grid Margin="0,20,0,0">
                                                            <!-- 辅助表空状态 -->
                                                            <StackPanel VerticalAlignment="Center"
                                                                        HorizontalAlignment="Center"
                                                                        Margin="0,60,0,60"
                                                                        Visibility="{Binding HasSecondaryPreviewData, 
                                                                                      Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                                                <materialDesign:PackIcon Kind="TableOff"
                                                                    Width="64" Height="64"
                                                                    Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                    Margin="0,0,0,20" />
                                                                <TextBlock Text="请先选择辅助表工作表"
                                                                           Style="{StaticResource MD3BodyLarge}"
                                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                           HorizontalAlignment="Center"
                                                                           FontWeight="Medium" />
                                                                <TextBlock Text="选择工作表后将显示数据预览"
                                                                           Style="{StaticResource MD3BodyMedium}"
                                                                           Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                                           HorizontalAlignment="Center"
                                                                           Margin="0,8,0,0" />
                                                            </StackPanel>

                                                            <!-- 辅助表数据显示 -->
                                                            <ScrollViewer
                                                                Visibility="{Binding HasSecondaryPreviewData, 
                                                                                        Converter={StaticResource BooleanToVisibilityConverter}}"
                                                                MaxHeight="500"
                                                                Style="{StaticResource MD3ScrollViewer}">
                                                                <StackPanel>
                                                                    <!-- 数据网格 -->
                                                                    <DataGrid
                                                                        ItemsSource="{Binding SecondaryPreviewData}"
                                                                        Style="{StaticResource MD3DataGrid}"
                                                                        AutoGenerateColumns="True"
                                                                        IsReadOnly="True"
                                                                        MaxHeight="450"
                                                                        materialDesign:DataGridAssist.CellPadding="8,4"
                                                                        materialDesign:DataGridAssist.ColumnHeaderPadding="8,8" />
                                                                </StackPanel>
                                                            </ScrollViewer>
                                                        </Grid>
                                                    </TabItem>
                                                </TabControl>
                                            </ScrollViewer>
                                        </Grid>
                                    </StackPanel>
                                </materialDesign:Card>

                            </StackPanel>
                        </ScrollViewer>

                        <!-- 底部操作栏 -->
                        <materialDesign:ColorZone Grid.Row="2"
                                                  Mode="Custom"
                                                  Background="{StaticResource MD3SurfaceVariantBrush}"
                                                  Foreground="{StaticResource MD3OnSurfaceVariantBrush}"
                                                  CornerRadius="0,0,20,20"
                                                  Padding="32,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!-- 状态信息区域 -->
                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <!-- 主状态信息 -->
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Information"
                                                                 Width="18" Height="18"
                                                                 VerticalAlignment="Center"
                                                                 Margin="0,0,12,0" />
                                        <TextBlock Text="{Binding StatusMessage}"
                                                   Style="{StaticResource MD3BodyMedium}"
                                                   FontWeight="Medium" />
                                    </StackPanel>

                                    <!-- 进度条 -->
                                    <ProgressBar Value="{Binding ProgressValue}"
                                                 Maximum="{Binding ProgressMaximum}"
                                                 Height="6"
                                                 Margin="0,12,0,0"
                                                 Width="500"
                                                 HorizontalAlignment="Left"
                                                 Style="{StaticResource MaterialDesignLinearProgressBar}"
                                                 Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                    <!-- 统计信息 -->
                                    <StackPanel Orientation="Horizontal"
                                                Margin="0,12,0,0"
                                                Visibility="{Binding IsBusy, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                        <!-- 主表行数 -->
                                        <materialDesign:Chip
                                            Content="{Binding PrimaryFile.RowCount, StringFormat='主表: {0}行'}"
                                            Style="{StaticResource MaterialDesignOutlineChip}"
                                            FontSize="12"
                                            Margin="0,0,12,0"
                                            Visibility="{Binding PrimaryFile.IsLoaded, 
                                                                           Converter={StaticResource BooleanToVisibilityConverter}}" />

                                        <!-- 辅助表行数 -->
                                        <materialDesign:Chip
                                            Content="{Binding SecondaryFile.RowCount, StringFormat='辅助表: {0}行'}"
                                            Style="{StaticResource MaterialDesignOutlineChip}"
                                            FontSize="12"
                                            Margin="0,0,12,0"
                                            Visibility="{Binding SecondaryFile.IsLoaded, 
                                                                           Converter={StaticResource BooleanToVisibilityConverter}}" />

                                        <!-- 字段映射数量 -->
                                        <materialDesign:Chip
                                            Content="{Binding FieldMappings.Count, StringFormat='{}{0}个映射'}"
                                            Style="{StaticResource MaterialDesignOutlineChip}"
                                            FontSize="12"
                                            Margin="0,0,12,0"
                                            Visibility="{Binding FieldMappings.Count, 
                                                                           Converter={StaticResource CountToVisibilityConverter}}" />

                                        <!-- 预览状态指示 -->
                                        <materialDesign:Chip Content="性能优化模式"
                                                             Style="{StaticResource MaterialDesignOutlineChip}"
                                                             FontSize="12"
                                                             Background="{StaticResource MD3TertiaryContainerBrush}"
                                                             Foreground="{StaticResource MD3OnTertiaryContainerBrush}"
                                                             Visibility="{Binding IsPreviewEnabled, 
                                                                           Converter={StaticResource InverseBooleanToVisibilityConverter}}" />

                                        <materialDesign:Chip Content="预览模式"
                                                             Style="{StaticResource MaterialDesignOutlineChip}"
                                                             FontSize="12"
                                                             Background="{StaticResource MD3PrimaryContainerBrush}"
                                                             Foreground="{StaticResource MD3OnPrimaryContainerBrush}"
                                                             Visibility="{Binding IsPreviewEnabled, 
                                                                           Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    </StackPanel>
                                </StackPanel>

                                <!-- 操作按钮区域 -->
                                <StackPanel Grid.Column="1"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center">

                                    <!-- 诊断按钮 -->
                                    <Button Command="{Binding DiagnoseMatchingCommand}"
                                            Style="{StaticResource MD3TextButton}"
                                            ToolTip="诊断匹配问题，分析数据兼容性"
                                            Margin="0,0,12,0">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Microscope"
                                                                     Width="18" Height="18"
                                                                     Margin="0,0,8,0" />
                                            <TextBlock Text="诊断" />
                                        </StackPanel>
                                    </Button>

                                    <!-- 保存配置按钮 -->
                                    <Button Command="{Binding SaveConfigurationCommand}"
                                            Style="{StaticResource MD3OutlinedButton}"
                                            ToolTip="保存当前配置以便后续使用"
                                            Margin="0,0,12,0">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="ContentSave"
                                                                     Width="18" Height="18"
                                                                     Margin="0,0,8,0" />
                                            <TextBlock Text="保存配置" />
                                        </StackPanel>
                                    </Button>

                                    <!-- 加载配置按钮 -->
                                    <Button Command="{Binding LoadConfigurationCommand}"
                                            Style="{StaticResource MD3OutlinedButton}"
                                            ToolTip="加载已保存的配置"
                                            Margin="0,0,12,0">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="FolderOpen"
                                                                     Width="18" Height="18"
                                                                     Margin="0,0,8,0" />
                                            <TextBlock Text="加载配置" />
                                        </StackPanel>
                                    </Button>

                                    <!-- 重置按钮 -->
                                    <Button Command="{Binding ResetConfigurationCommand}"
                                            Style="{StaticResource MD3OutlinedButton}"
                                            ToolTip="重置所有设置到默认状态"
                                            Margin="0,0,20,0">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Refresh"
                                                                     Width="18" Height="18"
                                                                     Margin="0,0,8,0" />
                                            <TextBlock Text="重置" />
                                        </StackPanel>
                                    </Button>

                                    <!-- 开始合并按钮 -->
                                    <Button Command="{Binding StartMergeCommand}"
                                            Style="{StaticResource MD3FilledButton}"
                                            Padding="32,12"
                                            FontSize="16"
                                            IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBooleanConverter}}"
                                            ToolTip="开始执行数据合并操作">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="PlayArrow"
                                                                     Width="20" Height="20"
                                                                     Margin="0,0,8,0" />
                                            <TextBlock Text="开始合并" FontWeight="Medium" />
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </materialDesign:ColorZone>
                    </Grid>
                </Border>

                <!-- 加载遮罩层 -->
                <Grid Background="#F0000000"
                      Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}">

                    <!-- 加载状态卡片 -->
                    <materialDesign:Card HorizontalAlignment="Center"
                                         VerticalAlignment="Center"
                                         Style="{StaticResource MD3ElevatedCard}"
                                         Padding="60"
                                         MinWidth="480"
                                         MaxWidth="700"
                                         materialDesign:ElevationAssist.Elevation="Dp12">
                        <StackPanel>
                            <!-- 加载动画区域 -->
                            <Grid HorizontalAlignment="Center" Margin="0,0,0,40">
                                <!-- 外圈 -->
                                <Ellipse Width="96" Height="96"
                                         Stroke="{StaticResource MD3PrimaryBrush}"
                                         StrokeThickness="2"
                                         Opacity="0.2" />

                                <!-- 内圈动画 -->
                                <Ellipse Width="96" Height="96"
                                         Stroke="{StaticResource MD3PrimaryBrush}"
                                         StrokeThickness="5"
                                         StrokeDashArray="24,72"
                                         RenderTransformOrigin="0.5,0.5">
                                    <Ellipse.RenderTransform>
                                        <RotateTransform x:Name="LoadingRotateTransform" />
                                    </Ellipse.RenderTransform>
                                    <Ellipse.Triggers>
                                        <EventTrigger RoutedEvent="Loaded">
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="LoadingRotateTransform"
                                                                     Storyboard.TargetProperty="Angle"
                                                                     From="0" To="360"
                                                                     Duration="0:0:2"
                                                                     RepeatBehavior="Forever">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseInOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Ellipse.Triggers>
                                </Ellipse>

                                <!-- 中心图标 -->
                                <materialDesign:PackIcon Kind="TableMergeCells"
                                                         Width="40" Height="40"
                                                         Foreground="{StaticResource MD3PrimaryBrush}"
                                                         HorizontalAlignment="Center"
                                                         VerticalAlignment="Center" />
                            </Grid>

                            <!-- 状态文本 -->
                            <TextBlock Text="{Binding StatusMessage}"
                                       Style="{StaticResource MD3TitleLarge}"
                                       HorizontalAlignment="Center"
                                       TextWrapping="Wrap"
                                       FontWeight="Medium"
                                       Margin="0,0,0,32" />

                            <!-- 进度条 -->
                            <ProgressBar Value="{Binding ProgressValue}"
                                         Maximum="{Binding ProgressMaximum}"
                                         Height="8"
                                         Style="{StaticResource MaterialDesignLinearProgressBar}"
                                         materialDesign:TransitionAssist.DisableTransitions="False" />

                            <!-- 进度文本 -->
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Center"
                                        Margin="0,20,0,0">
                                <TextBlock Style="{StaticResource MD3BodyLarge}">
                                    <Run Text="处理进度: " />
                                    <Run Text="{Binding ProgressValue, Mode=OneWay}" FontWeight="Medium" />
                                    <Run Text=" / " />
                                    <Run Text="{Binding ProgressMaximum, Mode=OneWay}" FontWeight="Medium" />
                                </TextBlock>

                                <TextBlock
                                    Text="{Binding ProgressValue, Mode=OneWay, 
                                                   Converter={StaticResource ProgressToPercentageConverter}}"
                                    Style="{StaticResource MD3BodyLarge}"
                                    FontWeight="Medium"
                                    Margin="20,0,0,0" />
                            </StackPanel>

                            <!-- 提示信息 -->
                            <materialDesign:Card Style="{StaticResource MD3OutlinedCard}"
                                                 Background="{StaticResource MD3TertiaryContainerBrush}"
                                                 Margin="0,32,0,0">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="InformationOutline"
                                                             Width="18" Height="18"
                                                             Foreground="{StaticResource MD3OnTertiaryContainerBrush}"
                                                             Margin="0,0,12,0" />
                                    <TextBlock Text="正在处理大量数据，请耐心等待..."
                                               Style="{StaticResource MD3BodyMedium}"
                                               Foreground="{StaticResource MD3OnTertiaryContainerBrush}" />
                                </StackPanel>
                            </materialDesign:Card>
                        </StackPanel>
                    </materialDesign:Card>
                </Grid>

                <!-- 消息提示栏 -->
                <materialDesign:Snackbar x:Name="MainSnackbar"
                                         MessageQueue="{materialDesign:MessageQueue}"
                                         VerticalAlignment="Bottom"
                                         HorizontalAlignment="Center"
                                         Margin="0,0,0,120" />

            </Grid>
        </materialDesign:DialogHost>
    </materialDesign:DialogHost>
</Window>